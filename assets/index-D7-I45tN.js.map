{"version":3,"file":"index-D7-I45tN.js","sources":["../../src/airportLoader.js","../../src/main.js"],"sourcesContent":["import * as Cesium from 'cesium';\r\n\r\n/**\r\n * Fetch airport details JSON\r\n */\r\nexport async function fetchAirportDetails() {\r\n    try {\r\n        const response = await fetch(`${import.meta.env.BASE_URL}assets/airport_details.json`);\r\n        if (!response.ok) throw new Error('Failed to load airport details');\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('‚ùå Error fetching airport details:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Load and render runway/taxiway surfaces\r\n * and upgrade airport labels to 3D blocks on the main runway.\r\n * @param {Cesium.Viewer} viewer The Cesium viewer instance\r\n//  * @param {Object} app The global app object containing filter state\r\n * @param {Object} data The airport details data (optional, fetched if not provided)\r\n */\r\nexport async function loadRunwaySurfaces(viewer, app, data = null) {\r\n    console.log('Loading airport surfaces...');\r\n    try {\r\n        if (!data) {\r\n            data = await fetchAirportDetails();\r\n        }\r\n\r\n        if (!data) return;\r\n\r\n        // Create a data source for airport surfaces\r\n        const dataSource = new Cesium.CustomDataSource('airport-surfaces');\r\n        viewer.dataSources.add(dataSource);\r\n\r\n        Object.entries(data).forEach(([icao, details]) => {\r\n            let longestRunway = null;\r\n            let maxLength = 0;\r\n\r\n            // Render Runways\r\n            if (details.runways) {\r\n                details.runways.forEach(feature => {\r\n                    const diffCoords = feature.geometry.coordinates;\r\n                    // Flatten coordinates for Cesium\r\n                    const positions = diffCoords.flat();\r\n                    const cartesians = Cesium.Cartesian3.fromDegreesArray(positions);\r\n\r\n                    dataSource.entities.add({\r\n                        corridor: {\r\n                            positions: cartesians,\r\n                            width: 45.0, // 45 meters wide\r\n                            material: Cesium.Color.fromCssColorString('#00ff41').withAlpha(0.3), // Cyber Green\r\n                            cornerType: Cesium.CornerType.MITERED,\r\n                            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\r\n                            // Only show when camera is relatively close (200km)\r\n                            distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 200000)\r\n                        },\r\n                        // Add metadata for click interaction\r\n                        properties: {\r\n                            type: 'airport',\r\n                            icao: icao,\r\n                            name: `Airport ${icao}`\r\n                        }\r\n                    });\r\n\r\n                    // Calculate length to find the main runway\r\n                    let length = 0;\r\n                    for (let i = 0; i < cartesians.length - 1; i++) {\r\n                        length += Cesium.Cartesian3.distance(cartesians[i], cartesians[i + 1]);\r\n                    }\r\n\r\n                    if (length > maxLength) {\r\n                        maxLength = length;\r\n                        longestRunway = cartesians;\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Render Taxiways\r\n            if (details.taxiways) {\r\n                details.taxiways.forEach(feature => {\r\n                    const diffCoords = feature.geometry.coordinates;\r\n                    const positions = diffCoords.flat();\r\n\r\n                    dataSource.entities.add({\r\n                        corridor: {\r\n                            positions: Cesium.Cartesian3.fromDegreesArray(positions),\r\n                            width: 20.0, // 20 meters wide\r\n                            material: Cesium.Color.fromCssColorString('#00ff41').withAlpha(0.15), // Fainter Green\r\n                            cornerType: Cesium.CornerType.ROUNDED,\r\n                            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\r\n                            distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 200000)\r\n                        },\r\n                        // Add metadata for click interaction\r\n                        properties: {\r\n                            type: 'airport',\r\n                            icao: icao,\r\n                            name: `Airport ${icao}`\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n\r\n            // Upgrade the existing airport marker if we found a main runway\r\n            if (longestRunway) {\r\n                const airportEntity = viewer.entities.getById(`airport-${icao}`);\r\n                if (airportEntity) {\r\n                    console.log(`[SkyNeedle] Upgrading airport ${icao} - Hiding generic label/pin`);\r\n                    // Calculate center of the longest runway\r\n                    const p1 = longestRunway[0];\r\n                    const p2 = longestRunway[longestRunway.length - 1];\r\n                    const center = Cesium.Cartesian3.midpoint(p1, p2, new Cesium.Cartesian3());\r\n\r\n                    // Move entity\r\n                    airportEntity.position = center;\r\n\r\n                    // HIDE VISUALS?\r\n                    // User requested to KEEP the white dot and label even with overlays.\r\n                    // So we removed the lines hiding point and label.\r\n                    if (airportEntity.billboard) airportEntity.billboard.show = false; // Legacy cleanup\r\n                } else {\r\n                    console.warn(`[SkyNeedle] Airport entity 'airport-${icao}' not found in viewer entities`);\r\n                }\r\n            } else {\r\n                console.log(`[SkyNeedle] No main runway found for ${icao}, generic label remains visible`);\r\n            }\r\n        });\r\n\r\n        console.log('‚úÖ Airport surfaces loaded and labels updated');\r\n\r\n    } catch (error) {\r\n        console.error('‚ùå Error loading airport details:', error);\r\n    }\r\n}\r\n","/**\r\n * SkyNeedle - Main Application Entry Point\r\n * 3D Flight Tracking PWA\r\n */\r\n\r\nimport * as Cesium from 'cesium';\r\nimport 'cesium/Build/Cesium/Widgets/widgets.css';\r\nimport { loadRunwaySurfaces } from './airportLoader.js';\r\n\r\n// Configuration - Using environment variables\r\nconst CESIUM_ION_TOKEN = import.meta.env.VITE_CESIUM_ION_TOKEN || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3N2VmNjQ5YS00MzNiLTRjODUtYTYwMS1hZjIwOGM3YWFkMDUiLCJpZCI6MzgwMzQwLCJpYXQiOjE3Njg3NDA5ODB9.ILdx02CrRUguqA-msX6n5l9-NRFuF6oHPGtqlgabJB4';\r\nconst OPENSKY_USERNAME = import.meta.env.VITE_OPENSKY_USERNAME || '';\r\nconst OPENSKY_PASSWORD = import.meta.env.VITE_OPENSKY_PASSWORD || '';\r\nconst MAX_AIRCRAFT_DISPLAY = 500; // Maximum number of aircraft to display at once\r\n\r\n// common ICAO airline codes for lookup\r\n// Airline Data with IATA Codes\r\nconst ICAO_AIRLINES = {\r\n    'THY': { name: 'Turkish Airlines', iata: 'TK' },\r\n    'PGT': { name: 'Pegasus Airlines', iata: 'PC' },\r\n    'BAW': { name: 'British Airways', iata: 'BA' },\r\n    'DLH': { name: 'Lufthansa', iata: 'LH' },\r\n    'AFR': { name: 'Air France', iata: 'AF' },\r\n    'KLM': { name: 'KLM Royal Dutch', iata: 'KL' },\r\n    'UAE': { name: 'Emirates', iata: 'EK' },\r\n    'QTR': { name: 'Qatar Airways', iata: 'QR' },\r\n    'ETD': { name: 'Etihad Airways', iata: 'EY' },\r\n    'DL': { name: 'Delta Air Lines', iata: 'DL' },\r\n    'AAL': { name: 'American Airlines', iata: 'AA' },\r\n    'UAL': { name: 'United Airlines', iata: 'UA' },\r\n    'RYR': { name: 'Ryanair', iata: 'FR' },\r\n    'EZY': { name: 'EasyJet', iata: 'U2' },\r\n    'WZZ': { name: 'Wizz Air', iata: 'W6' },\r\n    'SWR': { name: 'Swiss International', iata: 'LX' },\r\n    'AZA': { name: 'Alitalia', iata: 'AZ' },\r\n    'TAP': { name: 'TAP Air Portugal', iata: 'TP' },\r\n    'LOT': { name: 'LOT Polish Airlines', iata: 'LO' },\r\n    'ELY': { name: 'El Al', iata: 'LY' },\r\n    'FDB': { name: 'FlyDubai', iata: 'FZ' },\r\n    'RJA': { name: 'Royal Jordanian', iata: 'RJ' },\r\n    'MEA': { name: 'Middle East Airlines', iata: 'ME' },\r\n    'MSR': { name: 'EgyptAir', iata: 'MS' },\r\n    'RAM': { name: 'Royal Air Maroc', iata: 'AT' },\r\n    'ETH': { name: 'Ethiopian Airlines', iata: 'ET' },\r\n    'SVA': { name: 'Saudia', iata: 'SV' },\r\n    'QFA': { name: 'Qantas', iata: 'QF' },\r\n    'JAL': { name: 'Japan Airlines', iata: 'JL' },\r\n    'ANA': { name: 'All Nippon Airways', iata: 'NH' },\r\n    'CPA': { name: 'Cathay Pacific', iata: 'CX' },\r\n    'PIA': { name: 'Pakistan International', iata: 'PK' },\r\n    'AIC': { name: 'Air India', iata: 'AI' },\r\n    'CCA': { name: 'Air China', iata: 'CA' },\r\n    'CES': { name: 'China Eastern', iata: 'MU' },\r\n    'CSN': { name: 'China Southern', iata: 'CZ' },\r\n    'MAS': { name: 'Malaysia Airlines', iata: 'MH' },\r\n    'SIA': { name: 'Singapore Airlines', iata: 'SQ' },\r\n    'THA': { name: 'Thai Airways', iata: 'TG' },\r\n    'KAL': { name: 'Korean Air', iata: 'KE' },\r\n    'ANZ': { name: 'Air New Zealand', iata: 'NZ' },\r\n    'ACA': { name: 'Air Canada', iata: 'AC' },\r\n    'AMX': { name: 'Aeromexico', iata: 'AM' },\r\n    'LAN': { name: 'LATAM Airlines', iata: 'LA' },\r\n    'AVA': { name: 'Avianca', iata: 'AV' }\r\n};\r\n\r\nconst AIRPORTS = [\r\n    { name: 'Istanbul Airport', icao: 'LTFM', lat: 41.275, lon: 28.751, alt: 99 },\r\n    { name: 'Sabiha Gokcen', icao: 'LTFJ', lat: 40.898, lon: 29.309, alt: 93 },\r\n    { name: 'Ankara Esenboga', icao: 'LTAC', lat: 40.128, lon: 32.995, alt: 953 },\r\n    { name: 'Izmir Adnan Menderes', icao: 'LTBJ', lat: 38.292, lon: 27.157, alt: 126 },\r\n    { name: 'Antalya Airport', icao: 'LTAI', lat: 36.899, lon: 30.801, alt: 54 },\r\n    { name: 'Milas-Bodrum', icao: 'LTFE', lat: 37.250, lon: 27.664, alt: 6 },\r\n    { name: 'Dalaman Airport', icao: 'LTBS', lat: 36.716, lon: 28.791, alt: 6 },\r\n    { name: 'Adana Sakirpasa', icao: 'LTAF', lat: 36.982, lon: 35.280, alt: 20 },\r\n    { name: 'Trabzon Airport', icao: 'LTCG', lat: 40.995, lon: 39.789, alt: 31 },\r\n    { name: 'JFK International', icao: 'KJFK', lat: 40.645, lon: -73.785, alt: 10 },\r\n    { name: 'Heathrow Airport', icao: 'EGLL', lat: 51.470, lon: -0.454, alt: 25 },\r\n    { name: 'Frankfurt Airport', icao: 'EDDF', lat: 50.037, lon: 8.562, alt: 111 },\r\n    { name: 'Dubai International', icao: 'OMDB', lat: 25.253, lon: 55.365, alt: 19 }\r\n];\r\n\r\n// Set Cesium Ion token\r\nCesium.Ion.defaultAccessToken = CESIUM_ION_TOKEN;\r\n\r\n// Application state\r\nconst app = {\r\n    viewer: null,\r\n    selectedAircraft: null,\r\n    aircraftEntities: new Map(),\r\n    updateInterval: null,\r\n    lastFetchBounds: null,\r\n    cameraMoveTimeout: null,\r\n    lastAircraftData: [], // Store raw data for re-filtering\r\n    filters: {\r\n        showAirports: true,\r\n        showTraces: false\r\n    },\r\n    searchQuery: '', // Search query string\r\n    trackedEntity: null,\r\n    followMode: 'NONE', // 'NONE', 'TRACK', 'FOLLOW', 'COCKPIT'\r\n    geocoder: null, // Geocoder service\r\n    searchTimeout: null, // Timeout for debouncing search\r\n    // Debug mode for manual alignment\r\n    debugMode: false,\r\n    debugOffsets: {\r\n        x: 0.0,  // Left/Right (meters)\r\n        y: 0.0,  // Forward/Backward (meters)\r\n        z: 0.0   // Up/Down (meters)\r\n    },\r\n    selectionBracket: null // Selection bracket entity\r\n};\r\n\r\n/**\r\n * Initialize Cesium Viewer\r\n */\r\nasync function initCesiumViewer() {\r\n    console.log('Initializing Cesium viewer...');\r\n\r\n    // Debug: Check if credentials are loaded\r\n    console.log('Environment check:', {\r\n        hasUsername: !!OPENSKY_USERNAME,\r\n        username: OPENSKY_USERNAME || '(not set)',\r\n        hasPassword: !!OPENSKY_PASSWORD\r\n    });\r\n\r\n    app.viewer = new Cesium.Viewer('cesiumContainer', {\r\n        // Terrain and imagery\r\n        terrain: Cesium.Terrain.fromWorldTerrain(),\r\n        baseLayer: (function () {\r\n            const layer = Cesium.ImageryLayer.fromWorldImagery({\r\n                style: Cesium.IonWorldImageryStyle.AERIAL\r\n            });\r\n            layer.brightness = 0.6;\r\n            layer.contrast = 1.2;\r\n            layer.saturation = 0.2;\r\n            return layer;\r\n        })(),\r\n\r\n        // Disable default UI\r\n        animation: false,\r\n        timeline: false,\r\n        infoBox: false,\r\n        selectionIndicator: false,\r\n        baseLayerPicker: false,\r\n        geocoder: false,\r\n        homeButton: false,\r\n        sceneModePicker: false,\r\n        navigationHelpButton: false,\r\n        fullscreenButton: false,\r\n\r\n        // Scene settings - remove empty skybox to prevent errors\r\n        skyAtmosphere: false,\r\n\r\n        // Performance\r\n        // Performance - requestRenderMode disabled for smoother animations of moving objects\r\n        requestRenderMode: false,\r\n        maximumRenderTimeChange: Infinity\r\n    });\r\n\r\n    // Ensure animation is enabled for aircraft movement\r\n    app.viewer.clock.shouldAnimate = true;\r\n    app.viewer.clock.clockRange = Cesium.ClockRange.UNBOUNDED;\r\n\r\n    // Configure scene\r\n    const scene = app.viewer.scene;\r\n    scene.globe.baseColor = Cesium.Color.fromCssColorString('#0a0e14');\r\n    scene.backgroundColor = Cesium.Color.fromCssColorString('#000000');\r\n    scene.globe.enableLighting = false; // Disable sun lighting on globe\r\n\r\n    // Initialize Geocoder Service (Now with scene reference)\r\n    app.geocoder = new Cesium.IonGeocoderService({ scene: scene });\r\n\r\n    // FIX LIGHTING: Add a fixed directional light for 3D models (like the aircraft)\r\n    scene.light = new Cesium.DirectionalLight({\r\n        direction: new Cesium.Cartesian3(0.0, 0.0, -1.0), // Illuminating straight down\r\n        intensity: 2.0\r\n    });\r\n\r\n    // Set initial camera position (over Bodrum, Turkey)\r\n    app.viewer.camera.setView({\r\n        destination: Cesium.Cartesian3.fromDegrees(27.43, 37.04, 200000),\r\n        orientation: {\r\n            heading: 0.0,\r\n            pitch: -Cesium.Math.PI_OVER_TWO,\r\n            roll: 0.0\r\n        }\r\n    });\r\n\r\n    // Hook into the render loop for camera updates\r\n    app.viewer.scene.preUpdate.addEventListener(updateCamera);\r\n\r\n    // Initialize Selection Bracket\r\n    createSelectionBracket();\r\n\r\n    // Initialize Airports\r\n    initializeAirports();\r\n\r\n    // Load Runway and Taxiway Details\r\n    loadRunwaySurfaces(app.viewer, app);\r\n\r\n    // REMOVED: Real-time UI updates (per user request to fix inconsistencies)\r\n    // app.viewer.scene.preUpdate.addEventListener(updateSelectedAircraftUI);\r\n\r\n    console.log('Cesium viewer initialized');\r\n}\r\n\r\n/**\r\n * Load and render runway/taxiway surfaces\r\n */\r\nasync function loadRunwaySurfaces_OLD() {\r\n    console.log('Loading airport details...');\r\n    try {\r\n        const response = await fetch(`${import.meta.env.BASE_URL}assets/airport_details.json`);\r\n        if (!response.ok) throw new Error('Failed to load airport details');\r\n\r\n        const data = await response.json();\r\n\r\n        // Create a data source for airport surfaces\r\n        const dataSource = new Cesium.CustomDataSource('airport-surfaces');\r\n        app.viewer.dataSources.add(dataSource);\r\n\r\n        Object.entries(data).forEach(([icao, details]) => {\r\n            // Render Runways\r\n            if (details.runways) {\r\n                details.runways.forEach(feature => {\r\n                    const diffCoords = feature.geometry.coordinates;\r\n                    // Flatten coordinates for Cesium\r\n                    const positions = diffCoords.flat();\r\n\r\n                    dataSource.entities.add({\r\n                        show: new Cesium.CallbackProperty(() => app.filters.showAirports, false),\r\n                        corridor: {\r\n                            positions: Cesium.Cartesian3.fromDegreesArray(positions),\r\n                            width: 45.0, // 45 meters wide\r\n                            material: Cesium.Color.fromCssColorString('#00ff41').withAlpha(0.3), // Cyber Green\r\n                            cornerType: Cesium.CornerType.MITERED,\r\n                            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\r\n                            // Only show when camera is relatively close\r\n                            distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 200000)\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n\r\n            // Render Taxiways\r\n            if (details.taxiways) {\r\n                details.taxiways.forEach(feature => {\r\n                    const diffCoords = feature.geometry.coordinates;\r\n                    const positions = diffCoords.flat();\r\n\r\n                    dataSource.entities.add({\r\n                        corridor: {\r\n                            positions: Cesium.Cartesian3.fromDegreesArray(positions),\r\n                            width: 20.0, // 20 meters wide\r\n                            material: Cesium.Color.fromCssColorString('#00ff41').withAlpha(0.15), // Fainter Green\r\n                            cornerType: Cesium.CornerType.ROUNDED,\r\n                            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\r\n                            distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 200000)\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n        console.log('‚úÖ Airport surfaces loaded');\r\n\r\n    } catch (error) {\r\n        console.error('‚ùå Error loading airport details:', error);\r\n    }\r\n}\r\n\r\n/**\r\n * Create custom selection bracket entity\r\n */\r\nfunction createSelectionBracket() {\r\n    if (!app.viewer) return;\r\n\r\n    // Create a canvas for the bracket\r\n    const size = 64;\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = size;\r\n    canvas.height = size;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    const color = '#00ff41';\r\n    const thickness = 4;\r\n    const len = 16;\r\n\r\n    ctx.strokeStyle = color;\r\n    ctx.lineWidth = thickness;\r\n    ctx.lineCap = 'round';\r\n\r\n    // Top Left\r\n    ctx.beginPath();\r\n    ctx.moveTo(thickness, thickness + len);\r\n    ctx.lineTo(thickness, thickness);\r\n    ctx.lineTo(thickness + len, thickness);\r\n    ctx.stroke();\r\n\r\n    // Top Right\r\n    ctx.beginPath();\r\n    ctx.moveTo(size - thickness - len, thickness);\r\n    ctx.lineTo(size - thickness, thickness);\r\n    ctx.lineTo(size - thickness, thickness + len);\r\n    ctx.stroke();\r\n\r\n    // Bottom Left\r\n    ctx.beginPath();\r\n    ctx.moveTo(thickness, size - thickness - len);\r\n    ctx.lineTo(thickness, size - thickness);\r\n    ctx.lineTo(thickness + len, size - thickness);\r\n    ctx.stroke();\r\n\r\n    // Bottom Right\r\n    ctx.beginPath();\r\n    ctx.moveTo(size - thickness - len, size - thickness);\r\n    ctx.lineTo(size - thickness, size - thickness);\r\n    ctx.lineTo(size - thickness, size - thickness - len);\r\n    ctx.stroke();\r\n\r\n    app.selectionBracket = app.viewer.entities.add({\r\n        id: 'selection-bracket',\r\n        show: false,\r\n        billboard: {\r\n            image: canvas,\r\n            scale: 1.0,\r\n            horizontalOrigin: Cesium.HorizontalOrigin.CENTER,\r\n            verticalOrigin: Cesium.VerticalOrigin.CENTER,\r\n            disableDepthTestDistance: Number.POSITIVE_INFINITY, // Always on top\r\n            pixelOffset: new Cesium.Cartesian2(0, 0)\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Initialize Airport Markers\r\n * @param {Array<string>} hiddenIcaos - List of airport ICAOs to hide (because they have detailed surfaces)\r\n */\r\nfunction initializeAirports(hiddenIcaos = []) {\r\n    if (!app.viewer) return;\r\n\r\n    const pinBuilder = new Cesium.PinBuilder();\r\n\r\n    AIRPORTS.forEach(airport => {\r\n        // Check if this airport has detailed surfaces (should be hidden)\r\n        const shouldHideVisuals = hiddenIcaos.includes(airport.icao);\r\n\r\n        const entityOptions = {\r\n            id: `airport-${airport.icao}`,\r\n            position: Cesium.Cartesian3.fromDegrees(airport.lon, airport.lat, airport.alt),\r\n            properties: {\r\n                type: 'airport',\r\n                name: airport.name,\r\n                icao: airport.icao\r\n            }\r\n        };\r\n\r\n        // Only add visuals if NOT in the hidden list\r\n        if (!shouldHideVisuals) {\r\n            entityOptions.point = {\r\n                pixelSize: 8,\r\n                color: Cesium.Color.WHITE.withAlpha(0.8),\r\n                outlineColor: Cesium.Color.BLACK,\r\n                outlineWidth: 1,\r\n                heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\r\n                show: new Cesium.CallbackProperty(() => app.filters.showAirports, false),\r\n                distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 5000000) // Show from further away\r\n            };\r\n            entityOptions.label = {\r\n                text: airport.name,\r\n                font: '12px Inter, sans-serif', // Cleaner font\r\n                style: Cesium.LabelStyle.FILL_AND_OUTLINE,\r\n                fillColor: Cesium.Color.WHITE,\r\n                outlineColor: Cesium.Color.BLACK,\r\n                outlineWidth: 2,\r\n                verticalOrigin: Cesium.VerticalOrigin.BOTTOM,\r\n                pixelOffset: new Cesium.Cartesian2(0, -10), // Above the dot\r\n                distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 500000), // Hide labels when zoomed out\r\n                show: new Cesium.CallbackProperty(() => app.filters.showAirports, false)\r\n            };\r\n        }\r\n\r\n        app.viewer.entities.add(entityOptions);\r\n    });\r\n}\r\n\r\n/**\r\n * Get current camera viewport bounds\r\n */\r\nfunction getCameraViewportBounds() {\r\n    if (!app.viewer) return null;\r\n\r\n    const camera = app.viewer.camera;\r\n    const canvas = app.viewer.scene.canvas;\r\n\r\n    // Get corners of the viewport\r\n    const topLeft = camera.pickEllipsoid(new Cesium.Cartesian2(0, 0), app.viewer.scene.globe.ellipsoid);\r\n    const topRight = camera.pickEllipsoid(new Cesium.Cartesian2(canvas.clientWidth, 0), app.viewer.scene.globe.ellipsoid);\r\n    const bottomLeft = camera.pickEllipsoid(new Cesium.Cartesian2(0, canvas.clientHeight), app.viewer.scene.globe.ellipsoid);\r\n    const bottomRight = camera.pickEllipsoid(new Cesium.Cartesian2(canvas.clientWidth, canvas.clientHeight), app.viewer.scene.globe.ellipsoid);\r\n\r\n    // If camera is too far out (space view), return null to fetch all aircraft\r\n    if (!topLeft || !topRight || !bottomLeft || !bottomRight) {\r\n        return null;\r\n    }\r\n\r\n    // Convert to geographic coordinates\r\n    const corners = [topLeft, topRight, bottomLeft, bottomRight].map(cartesian => {\r\n        const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\r\n        return {\r\n            lat: Cesium.Math.toDegrees(cartographic.latitude),\r\n            lon: Cesium.Math.toDegrees(cartographic.longitude)\r\n        };\r\n    });\r\n\r\n    // Calculate bounding box\r\n    const lats = corners.map(c => c.lat);\r\n    const lons = corners.map(c => c.lon);\r\n\r\n    return {\r\n        lamin: Math.max(-90, Math.min(...lats)),   // South (clamp to valid range)\r\n        lamax: Math.min(90, Math.max(...lats)),    // North\r\n        lomin: Math.max(-180, Math.min(...lons)),  // West\r\n        lomax: Math.min(180, Math.max(...lons))    // East\r\n    };\r\n}\r\n\r\n/**\r\n * Fetch aircraft data from OpenSky Network\r\n */\r\nasync function fetchAircraftData(bounds = null) {\r\n    try {\r\n        // Use provided bounds, or calculate from camera viewport\r\n        let bbox = bounds;\r\n\r\n        if (!bbox) {\r\n            bbox = getCameraViewportBounds();\r\n        }\r\n\r\n        // If still no bounds (camera too far out), use a reasonable default\r\n        if (!bbox) {\r\n            console.log('Camera view too wide, fetching limited region');\r\n            bbox = {\r\n                lamin: 35.8,   // South (Turkey region)\r\n                lamax: 42.1,   // North\r\n                lomin: 25.6,   // West\r\n                lomax: 44.8    // East\r\n            };\r\n        }\r\n\r\n        console.log('Fetching aircraft for bounds:', bbox);\r\n\r\n        // Detect environment - use Render backend in production, local proxy in development\r\n        const isProduction = window.location.hostname === 'ozlphrt.github.io';\r\n        const API_BASE = isProduction\r\n            ? 'https://skyneedle-api.onrender.com'\r\n            : '';\r\n\r\n        // Use relative path in development (Vite proxy forwards to localhost:3002)\r\n        // Use absolute URL in production (points to Render backend)\r\n        const url = `${API_BASE}/api/states/all?lamin=${bbox.lamin}&lomin=${bbox.lomin}&lamax=${bbox.lamax}&lomax=${bbox.lomax}`;\r\n\r\n        console.log(`API Request: ${isProduction ? 'PRODUCTION' : 'DEVELOPMENT'} ‚Üí ${url}`);\r\n\r\n        // No need for client-side headers - the proxy handles authentication\r\n        const response = await fetch(url);\r\n\r\n        if (!response.ok) {\r\n            const errorText = await response.text();\r\n            console.error('‚ùå API Error:', {\r\n                status: response.status,\r\n                statusText: response.statusText,\r\n                response: errorText\r\n            });\r\n\r\n            if (response.status === 401) {\r\n                console.error('üîí Authentication failed - check server logs');\r\n            } else if (response.status === 429) {\r\n                console.error('‚è±Ô∏è Rate limit exceeded - reduce request frequency');\r\n            }\r\n\r\n            throw new Error(`OpenSky API error: ${response.status} ${response.statusText}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        console.log(`‚úÖ Fetched ${data.states?.length || 0} aircraft in viewport`);\r\n\r\n        return data.states || [];\r\n    } catch (error) {\r\n        console.error('‚ùå Error fetching aircraft data:', error);\r\n\r\n        // Check if proxy server is running\r\n        if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\r\n            console.error('üí° Is the proxy server running? Run \"npm run server\" in a separate terminal.');\r\n            updateStatus('ERROR: PROXY DISCONNECTED', true);\r\n            return [];\r\n        }\r\n\r\n        updateStatus('ERROR: API UNAVAILABLE', true);\r\n        return [];\r\n    }\r\n}\r\n\r\n/**\r\n * Test OpenSky API authentication (Debug utility)\r\n * Call this from browser console: testOpenSkyAuth()\r\n */\r\nwindow.testOpenSkyAuth = async function () {\r\n    console.log('üîç Testing OpenSky API Authentication...');\r\n    console.log('---');\r\n\r\n    const url = 'https://opensky-network.org/api/states/all?lamin=40&lamax=41&lomin=-74&lomax=-73';\r\n\r\n    try {\r\n        const response = await fetch(url, {\r\n            headers: OPENSKY_USERNAME ? {\r\n                'Authorization': 'Basic ' + btoa(`${OPENSKY_USERNAME}:${OPENSKY_PASSWORD}`)\r\n            } : {}\r\n        });\r\n\r\n        const rateLimitRemaining = response.headers.get('X-Rate-Limit-Remaining');\r\n        const rateLimitReset = response.headers.get('X-Rate-Limit-Reset');\r\n\r\n        console.log('‚úÖ API Connection Status:');\r\n        console.log(`   Status: ${response.status} ${response.statusText}`);\r\n        console.log(`   Authenticated: ${OPENSKY_USERNAME ? '‚úÖ Yes' : '‚ùå No (Anonymous)'}`);\r\n        console.log(`   Username: ${OPENSKY_USERNAME || '(none)'}`);\r\n        console.log(`   Rate Limit Remaining: ${rateLimitRemaining || 'Unknown'}`);\r\n        console.log(`   Rate Limit Reset: ${rateLimitReset ? new Date(rateLimitReset * 1000).toLocaleString() : 'Unknown'}`);\r\n\r\n        if (response.ok) {\r\n            const data = await response.json();\r\n            console.log(`   Aircraft in test area: ${data.states?.length || 0}`);\r\n            console.log('---');\r\n            console.log('‚úÖ API is working correctly!');\r\n        } else {\r\n            console.log('---');\r\n            console.log(`‚ùå API Error: ${response.status}`);\r\n            if (response.status === 401) {\r\n                console.log('   ‚Üí Check your username and password in .env file');\r\n            } else if (response.status === 429) {\r\n                console.log('   ‚Üí Rate limit exceeded. Wait or reduce request frequency.');\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.log('---');\r\n        console.log('‚ùå Connection Error:', error.message);\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Filter and prioritize aircraft for display\r\n */\r\nfunction filterAircraftForDisplay(aircraftData) {\r\n    // Filter out aircraft without position or on ground\r\n    const validAircraft = aircraftData.filter(state => {\r\n        const [, , , , , longitude, latitude, baro_altitude, on_ground, , , , , geo_altitude] = state;\r\n        const altitude = baro_altitude || geo_altitude || 0;\r\n\r\n        // Basic validity check\r\n        if (!longitude || !latitude || on_ground) return false;\r\n\r\n        // Search Filter\r\n        if (app.searchQuery) {\r\n            const query = app.searchQuery;\r\n            const callsign = state[1]?.trim().toUpperCase() || '';\r\n            const icao = state[0]?.toUpperCase() || '';\r\n            const origin = state[2]?.toUpperCase() || '';\r\n\r\n            if (!callsign.includes(query) && !icao.includes(query) && !origin.includes(query)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    });\r\n\r\n    // If under the limit, return all\r\n    if (validAircraft.length <= MAX_AIRCRAFT_DISPLAY) {\r\n        return validAircraft;\r\n    }\r\n\r\n    // Prioritize by altitude (higher altitude aircraft are more visible and interesting)\r\n    const sorted = validAircraft.sort((a, b) => {\r\n        const altA = a[7] || a[13] || 0; // baro_altitude or geo_altitude\r\n        const altB = b[7] || b[13] || 0;\r\n        return altB - altA; // Higher altitude first\r\n    });\r\n\r\n    console.log(`‚ö†Ô∏è Limiting display: ${validAircraft.length} aircraft available, showing top ${MAX_AIRCRAFT_DISPLAY} by altitude`);\r\n    return sorted.slice(0, MAX_AIRCRAFT_DISPLAY);\r\n}\r\n\r\n/**\r\n * Calculate predicted position based on velocity and heading\r\n * @param {number} longitude - Current longitude in degrees\r\n * @param {number} latitude - Current latitude in degrees\r\n * @param {number} altitude - Current altitude in meters\r\n * @param {number} velocity - Velocity in m/s\r\n * @param {number} heading - True track heading in degrees\r\n * @param {number} verticalRate - Vertical rate in m/s (optional)\r\n * @param {number} seconds - Number of seconds to predict ahead\r\n * @returns {object} Predicted position {longitude, latitude, altitude}\r\n */\r\nfunction predictPosition(longitude, latitude, altitude, velocity, heading, verticalRate, seconds) {\r\n    // If no velocity data, return current position\r\n    if (!velocity || velocity === 0) {\r\n        return { longitude, latitude, altitude };\r\n    }\r\n\r\n    // Earth's radius in meters\r\n    const EARTH_RADIUS = 6371000;\r\n\r\n    // Convert heading to radians (0¬∞ = North, 90¬∞ = East)\r\n    const headingRad = Cesium.Math.toRadians(heading);\r\n\r\n    // Calculate distance traveled in meters\r\n    const distance = velocity * seconds;\r\n\r\n    // Calculate change in latitude and longitude\r\n    // Œîlat = distance * cos(heading) / earth_radius (in radians)\r\n    // Œîlon = distance * sin(heading) / (earth_radius * cos(lat)) (in radians)\r\n    const latRad = Cesium.Math.toRadians(latitude);\r\n    const deltaLat = (distance * Math.cos(headingRad)) / EARTH_RADIUS;\r\n    const deltaLon = (distance * Math.sin(headingRad)) / (EARTH_RADIUS * Math.cos(latRad));\r\n\r\n    // Convert back to degrees\r\n    const newLatitude = latitude + Cesium.Math.toDegrees(deltaLat);\r\n    const newLongitude = longitude + Cesium.Math.toDegrees(deltaLon);\r\n\r\n    // Calculate altitude change if vertical rate is available\r\n    const newAltitude = altitude + (verticalRate || 0) * seconds;\r\n\r\n    return {\r\n        longitude: newLongitude,\r\n        latitude: newLatitude,\r\n        altitude: Math.max(0, newAltitude) // Ensure altitude doesn't go negative\r\n    };\r\n}\r\n\r\n/**\r\n * Create or update position property with interpolation\r\n * @param {object} entity - Cesium entity\r\n * @param {number} longitude - Current longitude\r\n * @param {number} latitude - Current latitude\r\n * @param {number} altitude - Current altitude in meters\r\n * @param {number} velocity - Velocity in m/s\r\n * @param {number} heading - Heading in degrees\r\n * @param {number} verticalRate - Vertical rate in m/s\r\n * @returns {SampledPositionProperty} Position property with interpolation\r\n */\r\nfunction createInterpolatedPosition(entity, longitude, latitude, altitude, velocity, heading, verticalRate) {\r\n    // Use viewer clock time to ensure synchronization with the scene\r\n    const currentTime = app.viewer ? app.viewer.clock.currentTime : Cesium.JulianDate.now();\r\n    const futureTime = Cesium.JulianDate.addSeconds(currentTime, 60, new Cesium.JulianDate()); // Predict 60s ahead\r\n\r\n    // Create or get existing SampledPositionProperty\r\n    let positionProperty;\r\n    let startPosition;\r\n\r\n    if (entity && entity.position instanceof Cesium.SampledPositionProperty) {\r\n        positionProperty = entity.position;\r\n\r\n        // VISUAL CONTINUITY: Start from where the aircraft *currently looks like it is*\r\n        // This prevents the \"snap\" effect when the API position differs from the predicted position\r\n        const visualPosition = entity.position.getValue(currentTime);\r\n        if (visualPosition) {\r\n            startPosition = visualPosition;\r\n        } else {\r\n            // Fallback if no visual position is available (shouldn't happen often for existing entities)\r\n            startPosition = Cesium.Cartesian3.fromDegrees(longitude, latitude, altitude);\r\n        }\r\n\r\n        // Cleanup: Remove samples in the overlapping future window to prevent conflicts\r\n        // We are redefining the path from currentTime onwards\r\n        positionProperty.removeSamples(\r\n            new Cesium.TimeInterval({\r\n                start: currentTime,\r\n                stop: Cesium.JulianDate.addSeconds(currentTime, 3600, new Cesium.JulianDate())\r\n            })\r\n        );\r\n\r\n        // Cleanup: Remove very old samples to save memory (older than 300s)\r\n        positionProperty.removeSamples(\r\n            new Cesium.TimeInterval({\r\n                start: Cesium.JulianDate.addSeconds(currentTime, -3600, new Cesium.JulianDate()),\r\n                stop: Cesium.JulianDate.addSeconds(currentTime, -300, new Cesium.JulianDate())\r\n            })\r\n        );\r\n    } else {\r\n        positionProperty = new Cesium.SampledPositionProperty();\r\n        // Use Hermite polynomial approximation for smoother curved paths\r\n        positionProperty.setInterpolationOptions({\r\n            interpolationDegree: 2,\r\n            interpolationAlgorithm: Cesium.HermitePolynomialApproximation\r\n        });\r\n        startPosition = Cesium.Cartesian3.fromDegrees(longitude, latitude, altitude);\r\n    }\r\n\r\n    // Add the start point (continuity point)\r\n    positionProperty.addSample(currentTime, startPosition);\r\n\r\n    // Calculate and add predicted future position\r\n    const predicted = predictPosition(\r\n        longitude, latitude, altitude,\r\n        velocity, heading, verticalRate,\r\n        60 // Predict 60 seconds ahead to ensure overlap\r\n    );\r\n    const futurePosition = Cesium.Cartesian3.fromDegrees(\r\n        predicted.longitude,\r\n        predicted.latitude,\r\n        predicted.altitude\r\n    );\r\n    positionProperty.addSample(futureTime, futurePosition);\r\n\r\n    return positionProperty;\r\n}\r\n\r\n/**\r\n * Update aircraft visualization\r\n */\r\nfunction updateAircraftDisplay(aircraftData) {\r\n    if (!app.viewer) return;\r\n\r\n    // Use cached data if not provided (for filter updates)\r\n    if (!aircraftData) {\r\n        aircraftData = app.lastAircraftData;\r\n    } else {\r\n        app.lastAircraftData = aircraftData;\r\n    }\r\n\r\n    const entities = app.viewer.entities;\r\n    const currentIds = new Set();\r\n\r\n    // Filter aircraft to display limit\r\n    const displayAircraft = filterAircraftForDisplay(aircraftData);\r\n\r\n    displayAircraft.forEach(state => {\r\n        const [\r\n            icao24, callsign, origin_country, time_position, last_contact,\r\n            longitude, latitude, baro_altitude, on_ground, velocity,\r\n            true_track, vertical_rate, sensors, geo_altitude, squawk, spi, position_source\r\n        ] = state;\r\n\r\n        const id = icao24; // Main ID (Visual Model)\r\n        const trackId = `${id}-track`; // Secondary ID (Path/Physics)\r\n\r\n        currentIds.add(id);\r\n        currentIds.add(trackId);\r\n\r\n        const altitude = (baro_altitude || geo_altitude || 0);\r\n        const velocityMs = (velocity || 0) * 0.51444;\r\n        const verticalRateMs = (vertical_rate || 0); // OpenSky vertical_rate is already in m/s\r\n        const heading = true_track || 0;\r\n\r\n        // --- 1. Track Entity (Physics/Path) ---\r\n        // Handles interpolation and the trailing path. Invisible.\r\n        let trackEntity = entities.getById(trackId);\r\n        let visualEntity = entities.getById(id);\r\n\r\n        let positionProperty;\r\n\r\n        if (!trackEntity) {\r\n            positionProperty = createInterpolatedPosition(\r\n                null, longitude, latitude, altitude, velocityMs, heading, verticalRateMs\r\n            );\r\n\r\n            trackEntity = entities.add({\r\n                id: trackId,\r\n                position: positionProperty,\r\n                orientation: new Cesium.VelocityOrientationProperty(positionProperty),\r\n                point: {\r\n                    pixelSize: 1,\r\n                    color: Cesium.Color.RED.withAlpha(0.0),\r\n                    outlineWidth: 0\r\n                },\r\n                // Trail on track entity (has proper SampledPositionProperty)\r\n                path: {\r\n                    leadTime: 0,\r\n                    trailTime: 300,\r\n                    width: 10,\r\n                    material: Cesium.Color.YELLOW.withAlpha(0.25),\r\n                    show: new Cesium.CallbackProperty(() => app.filters.showTraces, false)\r\n                },\r\n                // Drop line to ground for depth perception\r\n                polyline: {\r\n                    positions: new Cesium.CallbackProperty((time, result) => {\r\n                        const pos = trackEntity.position.getValue(time);\r\n                        if (!pos) return result;\r\n                        const carto = Cesium.Cartographic.fromCartesian(pos);\r\n                        const groundPos = Cesium.Cartesian3.fromDegrees(\r\n                            Cesium.Math.toDegrees(carto.longitude),\r\n                            Cesium.Math.toDegrees(carto.latitude),\r\n                            0\r\n                        );\r\n                        return [pos, groundPos];\r\n                    }, false),\r\n                    width: 1,\r\n                    material: new Cesium.PolylineDashMaterialProperty({\r\n                        color: Cesium.Color.WHITE.withAlpha(0.2),\r\n                        dashLength: 16\r\n                    }),\r\n                    show: new Cesium.CallbackProperty(() => {\r\n                        // Show if traces are enabled AND (it's selected OR camera is high up)\r\n                        if (!app.filters.showTraces) return false;\r\n                        if (app.selectedAircraft && (app.selectedAircraft.id === id || app.selectedAircraft.id === trackId)) return true;\r\n\r\n                        // Also show in overview mode (height > 50km)\r\n                        return app.viewer.camera.positionCartographic.height > 50000;\r\n                    }, false),\r\n                    distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 1000000)\r\n                }\r\n            });\r\n        } else {\r\n            positionProperty = createInterpolatedPosition(\r\n                trackEntity, longitude, latitude, altitude, velocityMs, heading, verticalRateMs\r\n            );\r\n            if (trackEntity.position !== positionProperty) {\r\n                trackEntity.position = positionProperty;\r\n            }\r\n        }\r\n\r\n        // --- 2. Visual Entity (Model/Interaction) ---\r\n        // This is the MAIN entity the user clicks and sees.\r\n        // It follows the Track Entity with an offset.\r\n\r\n        // OFFSETS REMOVED - Trail should align with aircraft center\r\n        // The visual model and trail now share the same position (no offset)\r\n        // This ensures the trail emanates from the aircraft's actual position\r\n        // FIXED OFFSETS (Aligned via Manual Debug Mode)\r\n        // These are now applied to the MODEL NODES to scale correctly with minimumPixelSize\r\n        const MODEL_OFFSET_X = 55.40;\r\n        const MODEL_OFFSET_Y = -55.00; // Original -114.00 + 59.00 increment\r\n        const MODEL_OFFSET_Z = -10.00;\r\n\r\n        if (!visualEntity) {\r\n            // Create Translation Callback for NodeTransformationProperty\r\n            const translationCallback = new Cesium.CallbackProperty((time, result) => {\r\n                const x = MODEL_OFFSET_X + app.debugOffsets.x;\r\n                const y = MODEL_OFFSET_Y + app.debugOffsets.y;\r\n                const z = MODEL_OFFSET_Z + app.debugOffsets.z;\r\n\r\n                // Reuse result object if available for performance\r\n                if (!result) {\r\n                    return new Cesium.Cartesian3(x, y, z);\r\n                }\r\n                result.x = x;\r\n                result.y = y;\r\n                result.z = z;\r\n                return result;\r\n            }, false);\r\n\r\n            // Create NodeTransformationProperty\r\n            const nodeTransform = new Cesium.NodeTransformationProperty({\r\n                translation: translationCallback\r\n            });\r\n\r\n            // Targets based on debug output\r\n            const transformations = {\r\n                'Sketchfab_model': nodeTransform,\r\n                'ba14754abb1947bba7d9b51a2bc63084.fbx': nodeTransform,\r\n                'RootNode': nodeTransform\r\n            };\r\n\r\n            visualEntity = entities.add({\r\n                id: id,\r\n                // Direct position reference (No World Offset)\r\n                position: trackEntity.position,\r\n                orientation: trackEntity.orientation,\r\n                // Model Definition\r\n                // Model Definition\r\n                model: {\r\n                    uri: `${import.meta.env.BASE_URL}assets/boeing_767-200er.glb`,\r\n                    minimumPixelSize: 32,\r\n                    maximumScale: 200,\r\n                    runAnimations: false,\r\n                    nodeTransformations: transformations,\r\n\r\n                    // Gradual Fading via Scaling (Shrink to zero)\r\n                    scale: new Cesium.CallbackProperty((time, result) => {\r\n                        const cameraPos = app.viewer.camera.positionWC;\r\n                        // fast distance check using entity position\r\n                        const entityPos = trackEntity.position.getValue(time);\r\n                        if (!entityPos) return 1.0;\r\n\r\n                        const dist = Cesium.Cartesian3.distance(cameraPos, entityPos);\r\n\r\n                        // Fade range: start 50km, end 500km (User requested 500km)\r\n                        const near = 50000.0;\r\n                        const far = 500000.0;\r\n\r\n                        if (dist < near) {\r\n                            return 1.0;\r\n                        } else if (dist > far) {\r\n                            return 0.0; // Invisible\r\n                        } else {\r\n                            // Valid range: interpolate 1.0 -> 0.0\r\n                            return 1.0 - ((dist - near) / (far - near));\r\n                        }\r\n                    }, false),\r\n\r\n                    distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 500000)\r\n                },\r\n                // Label\r\n                label: {\r\n                    text: callsign?.trim() || icao24,\r\n                    font: 'bold 14px \"JetBrains Mono\", monospace',\r\n                    fillColor: Cesium.Color.fromCssColorString('#00ff41'),\r\n                    outlineColor: Cesium.Color.BLACK,\r\n                    outlineWidth: 2,\r\n                    style: Cesium.LabelStyle.FILL_AND_OUTLINE,\r\n                    verticalOrigin: Cesium.VerticalOrigin.BOTTOM,\r\n                    pixelOffset: new Cesium.Cartesian2(0, -20),\r\n                    distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 500000),\r\n                    // Gradual Fading for Labels provided by Cesium\r\n                    translucencyByDistance: new Cesium.NearFarScalar(50000, 1.0, 500000, 0.0),\r\n                    disableDepthTestDistance: Number.POSITIVE_INFINITY\r\n                },\r\n                // Properties\r\n                properties: {\r\n                    callsign: callsign?.trim() || 'N/A',\r\n                    altitude: Math.round(baro_altitude || geo_altitude || 0),\r\n                    velocity: Math.round(velocity || 0),\r\n                    heading: Math.round(heading),\r\n                    origin: origin_country,\r\n                    type: 'aircraft'\r\n                }\r\n            });\r\n        } else {\r\n            // Update Properties\r\n            visualEntity.label.text = callsign?.trim() || icao24;\r\n            visualEntity.properties.altitude = Math.round(baro_altitude || geo_altitude || 0);\r\n            visualEntity.properties.velocity = Math.round(velocity || 0);\r\n            visualEntity.properties.heading = Math.round(heading);\r\n\r\n            // Ensure orientation matches\r\n            if (visualEntity.orientation !== trackEntity.orientation) {\r\n                visualEntity.orientation = trackEntity.orientation;\r\n            }\r\n\r\n            // Sync position if needed (Direct reference)\r\n            if (visualEntity.position !== trackEntity.position) {\r\n                visualEntity.position = trackEntity.position;\r\n            }\r\n        }\r\n    });\r\n\r\n    // Remove aircraft that are no longer in the data\r\n    const allEntities = entities.values;\r\n    for (let i = allEntities.length - 1; i >= 0; i--) {\r\n        const entity = allEntities[i];\r\n\r\n        // Skip non-aircraft entities (like airports and the selection bracket)\r\n        if (entity.id === 'selection-bracket') {\r\n            continue;\r\n        }\r\n\r\n        if (entity.properties && entity.properties.type && entity.properties.type.getValue() === 'airport') {\r\n            continue;\r\n        }\r\n\r\n        if (!currentIds.has(entity.id)) {\r\n            entities.remove(entity);\r\n        }\r\n    }\r\n\r\n    const totalAvailable = aircraftData.filter(state => {\r\n        const [, , , , , longitude, latitude, , on_ground] = state;\r\n        return longitude && latitude && !on_ground;\r\n    }).length;\r\n\r\n    if (totalAvailable > MAX_AIRCRAFT_DISPLAY) {\r\n        updateStatus(`TRACKING ${currentIds.size}/${totalAvailable} AIRCRAFT`);\r\n    } else {\r\n        updateStatus(`TRACKING ${currentIds.size} AIRCRAFT`);\r\n    }\r\n\r\n    // Force a frame render\r\n    app.viewer.scene.requestRender();\r\n}\r\n\r\n/**\r\n * Update camera position based on mode\r\n */\r\nfunction updateCamera() {\r\n    if (!app.viewer || !app.trackedEntity || app.followMode === 'NONE') return;\r\n\r\n    const entity = app.trackedEntity;\r\n    // Check if the entity still exists in the collection\r\n    if (!app.viewer.entities.contains(entity)) {\r\n        stopCameraModes();\r\n        return;\r\n    }\r\n\r\n    const position = entity.position.getValue(app.viewer.clock.currentTime);\r\n\r\n    // If entity has no position (e.g. lost signal), stop tracking\r\n    if (!position) {\r\n        return;\r\n    }\r\n\r\n    if (app.followMode === 'TRACK') {\r\n        // Cesium handles tracking automatically via viewer.trackedEntity\r\n        // We just ensure it's set (it might be unset if user pans away or we switch modes)\r\n        if (app.viewer.trackedEntity !== entity) {\r\n            app.viewer.trackedEntity = entity;\r\n        }\r\n    } else if (app.followMode === 'FOLLOW') {\r\n        // Custom chase camera\r\n\r\n        // Get heading\r\n        let heading = 0;\r\n        const orientation = entity.orientation ? entity.orientation.getValue(app.viewer.clock.currentTime) : null;\r\n\r\n        if (orientation) {\r\n            heading = Cesium.HeadingPitchRoll.fromQuaternion(orientation).heading;\r\n        } else {\r\n            heading = Cesium.Math.toRadians(entity.properties.heading.getValue() || 0);\r\n        }\r\n\r\n        const distance = 500; // meters behind\r\n\r\n        if (app.viewer.trackedEntity) {\r\n            app.viewer.trackedEntity = undefined;\r\n        }\r\n\r\n        const headingPitchRange = new Cesium.HeadingPitchRange(\r\n            heading,\r\n            Cesium.Math.toRadians(-20), // Slight look down\r\n            distance\r\n        );\r\n\r\n        app.viewer.camera.lookAt(position, headingPitchRange);\r\n\r\n    } else if (app.followMode === 'GROUND') {\r\n        const targetPos = entity.position.getValue(app.viewer.clock.currentTime);\r\n        if (!targetPos || !app.groundCameraPos) return;\r\n\r\n        // Calculate direction from ground to aircraft\r\n        const direction = Cesium.Cartesian3.normalize(\r\n            Cesium.Cartesian3.subtract(targetPos, app.groundCameraPos, new Cesium.Cartesian3()),\r\n            new Cesium.Cartesian3()\r\n        );\r\n\r\n        // Update camera position and orientation\r\n        app.viewer.camera.setView({\r\n            destination: app.groundCameraPos,\r\n            orientation: {\r\n                direction: direction,\r\n                up: Cesium.Cartesian3.normalize(app.groundCameraPos, new Cesium.Cartesian3())\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Stop active camera modes\r\n */\r\nfunction stopCameraModes() {\r\n    app.followMode = 'NONE';\r\n    app.trackedEntity = null;\r\n    app.viewer.trackedEntity = undefined;\r\n\r\n    // Release camera from lookAt\r\n    app.viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\r\n}\r\n\r\n/**\r\n * Start tracking an entity (Lock view)\r\n */\r\nfunction startTracking(entity) {\r\n    if (!entity) return;\r\n\r\n    // If already following, we need to release lookAt first\r\n    if (app.followMode === 'FOLLOW') {\r\n        app.viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\r\n    }\r\n\r\n    app.trackedEntity = entity;\r\n    app.followMode = 'TRACK';\r\n    app.viewer.trackedEntity = entity;\r\n    updateStatus(`TRACKING ${entity.properties.callsign || entity.id}`);\r\n    setTraceVisibility(true);\r\n}\r\n\r\n/**\r\n * Start following an entity (Chase view)\r\n */\r\nfunction startFollowing(entity) {\r\n    if (!entity) return;\r\n    app.trackedEntity = entity;\r\n    app.followMode = 'FOLLOW';\r\n    // Native tracking disabled in update loop to allow custom lookAt\r\n    updateStatus(`FOLLOWING ${entity.properties.callsign || entity.id}`);\r\n    setTraceVisibility(true);\r\n}\r\n\r\n/**\r\n * Start ground view (Look up from ground)\r\n */\r\nfunction startGroundView(entity) {\r\n    if (!entity) return;\r\n\r\n    const position = entity.position.getValue(app.viewer.clock.currentTime);\r\n    if (!position) return;\r\n\r\n    const cartographic = Cesium.Cartographic.fromCartesian(position);\r\n\r\n    // Position camera on ground directly below or slightly offset\r\n    const groundPos = Cesium.Cartesian3.fromDegrees(\r\n        Cesium.Math.toDegrees(cartographic.longitude),\r\n        Cesium.Math.toDegrees(cartographic.latitude),\r\n        10 // 10 meters above ground\r\n    );\r\n\r\n    app.trackedEntity = entity;\r\n    app.followMode = 'GROUND';\r\n    app.groundCameraPos = groundPos;\r\n\r\n    // Release from any existing tracking\r\n    app.viewer.trackedEntity = undefined;\r\n    app.viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\r\n\r\n    // Smoothly fly to ground position first\r\n    app.viewer.camera.flyTo({\r\n        destination: groundPos,\r\n        orientation: {\r\n            heading: Cesium.Math.toRadians(0),\r\n            pitch: Cesium.Math.toRadians(45),\r\n            roll: 0.0\r\n        },\r\n        duration: 2\r\n    });\r\n\r\n    updateStatus(`GROUND VIEW: ${entity.properties.callsign || entity.id}`);\r\n}\r\n\r\n/**\r\n * Start cockpit view\r\n */\r\n\r\n\r\n/**\r\n * Update status indicator\r\n */\r\nfunction updateStatus(text, isError = false) {\r\n    const statusText = document.querySelector('.status-text');\r\n    const statusIndicator = document.querySelector('.status-indicator');\r\n\r\n    if (statusText) {\r\n        statusText.textContent = text;\r\n    }\r\n\r\n    if (statusIndicator) {\r\n        statusIndicator.style.background = isError ? '#ff4444' : '#00ff41';\r\n    }\r\n}\r\n\r\n/**\r\n * Setup UI event listeners\r\n */\r\nfunction setupEventListeners() {\r\n    // Search input\r\n    const searchInput = document.getElementById('searchInput');\r\n    searchInput?.addEventListener('input', handleSearch);\r\n\r\n    // Camera controls\r\n    // Overview listener moved to setupEventListeners to consolidate\r\n\r\n    // Close details panel\r\n    document.getElementById('closeDetails')?.addEventListener('click', () => {\r\n        document.getElementById('aircraftDetails')?.classList.add('hidden');\r\n        app.selectedAircraft = null;\r\n        if (app.selectionBracket) app.selectionBracket.show = false;\r\n    });\r\n\r\n    // Aircraft click handler\r\n    const handler = new Cesium.ScreenSpaceEventHandler(app.viewer.scene.canvas);\r\n    handler.setInputAction((click) => {\r\n        // Use drillPick to get all objects at the click position (handling overlapping bracket/aircraft)\r\n        const pickedObjects = app.viewer.scene.drillPick(click.position);\r\n\r\n        if (Cesium.defined(pickedObjects) && pickedObjects.length > 0) {\r\n            // Find the first relevant entity (aircraft or airport)\r\n            // Skip the selection bracket if it's the top item\r\n            let targetEntity = null;\r\n\r\n            for (let i = 0; i < pickedObjects.length; i++) {\r\n                const picked = pickedObjects[i];\r\n                const entityId = (typeof picked.id === 'string') ? picked.id : (picked.id ? picked.id.id : null);\r\n\r\n                if (entityId === 'selection-bracket') {\r\n                    continue; // Skip the bracket itself\r\n                }\r\n\r\n                if (picked.id instanceof Cesium.Entity) {\r\n                    targetEntity = picked.id;\r\n                    break; // Found a valid entity\r\n                }\r\n            }\r\n\r\n            if (targetEntity) {\r\n                showAircraftDetails(targetEntity);\r\n            } else {\r\n                // Clicked only on bracket or something irrelevant? Deselect.\r\n                // Or maybe just do nothing if we clicked bracket? \r\n                // Let's deselect only if we really found nothing relevant in the stack\r\n                // But actually, if we click 'nothing' (sky/ground), drillPick might be empty or contain non-entities.\r\n            }\r\n        } else {\r\n            // Clicked on empty space\r\n            document.getElementById('aircraftDetails')?.classList.add('hidden');\r\n            app.selectedAircraft = null;\r\n            if (app.selectionBracket) app.selectionBracket.show = false;\r\n        }\r\n    }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n    // Aircraft Detail Action Buttons\r\n    document.getElementById('detailOverview')?.addEventListener('click', () => {\r\n        stopCameraModes();\r\n        setTraceVisibility(false);\r\n        app.viewer.camera.cancelFlight();\r\n        app.viewer.camera.setView({\r\n            destination: Cesium.Cartesian3.fromDegrees(27.43, 37.04, 200000),\r\n            orientation: {\r\n                heading: 0.0,\r\n                pitch: -Cesium.Math.PI_OVER_TWO,\r\n                roll: 0.0\r\n            }\r\n        });\r\n    });\r\n\r\n    document.getElementById('detailTrack')?.addEventListener('click', () => {\r\n        if (app.selectedAircraft) startTracking(app.selectedAircraft);\r\n    });\r\n\r\n    document.getElementById('detailFollow')?.addEventListener('click', () => {\r\n        if (app.selectedAircraft) startFollowing(app.selectedAircraft);\r\n    });\r\n\r\n    document.getElementById('detailGround')?.addEventListener('click', () => {\r\n        if (app.selectedAircraft) startGroundView(app.selectedAircraft);\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    // Debug Panel - Close Button\r\n    document.getElementById('closeDebug')?.addEventListener('click', () => {\r\n        app.debugMode = false;\r\n        document.getElementById('debugPanel')?.classList.add('hidden');\r\n    });\r\n\r\n    // Debug Panel - Reset Offsets\r\n    document.getElementById('resetOffsets')?.addEventListener('click', () => {\r\n        app.debugOffsets.x = 0.0;\r\n        app.debugOffsets.y = 0.0;\r\n        app.debugOffsets.z = 0.0;\r\n        updateDebugUI();\r\n        console.log('üîß Offsets reset to zero');\r\n    });\r\n\r\n    // Debug Panel - Copy Offsets\r\n    document.getElementById('copyOffsets')?.addEventListener('click', () => {\r\n        const offsetText = `// Aircraft Model Offsets\\nconst MODEL_OFFSET_X = ${app.debugOffsets.x.toFixed(2)}; // Left/Right\\nconst MODEL_OFFSET_Y = ${app.debugOffsets.y.toFixed(2)}; // Forward/Backward\\nconst MODEL_OFFSET_Z = ${app.debugOffsets.z.toFixed(2)}; // Up/Down`;\r\n\r\n        navigator.clipboard.writeText(offsetText).then(() => {\r\n            console.log('‚úÖ Offset values copied to clipboard!');\r\n            console.log(offsetText);\r\n            alert('Offset values copied to clipboard!');\r\n        }).catch(err => {\r\n            console.error('‚ùå Failed to copy:', err);\r\n        });\r\n    });\r\n\r\n    // Debug Panel - Apply Offsets to All\r\n    document.getElementById('applyOffsets')?.addEventListener('click', () => {\r\n        console.log('‚úÖ Offsets saved and will be applied to all aircraft:', app.debugOffsets);\r\n        alert(`Offsets applied: X=${app.debugOffsets.x.toFixed(2)}m, Y=${app.debugOffsets.y.toFixed(2)}m, Z=${app.debugOffsets.z.toFixed(2)}m`);\r\n        // The offsets are already being used in the position calculation, so just confirm\r\n    });\r\n\r\n    // Keyboard Controls for Debug Mode\r\n    document.addEventListener('keydown', (event) => {\r\n        const controlKeys = ['w', 'a', 's', 'd', 'q', 'e', 'W', 'A', 'S', 'D', 'Q', 'E'];\r\n\r\n        // Toggle Debug Mode with CTRL+SHIFT+ALT+D\r\n        if (event.ctrlKey && event.shiftKey && event.altKey && event.key.toLowerCase() === 'd') {\r\n            event.preventDefault();\r\n            app.debugMode = !app.debugMode;\r\n            const debugPanel = document.getElementById('debugPanel');\r\n            if (app.debugMode) {\r\n                debugPanel?.classList.remove('hidden');\r\n                console.log('üîß Debug Mode ENABLED - Use WASDQE keys to adjust aircraft position');\r\n            } else {\r\n                debugPanel?.classList.add('hidden');\r\n                console.log('üîß Debug Mode DISABLED');\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!app.debugMode || !app.selectedAircraft) return;\r\n\r\n        if (controlKeys.includes(event.key)) {\r\n            event.preventDefault();\r\n        }\r\n\r\n        // Determine adjustment magnitude\r\n        let step = 1.0; // Default: 1 meter\r\n        if (event.shiftKey) step = 0.1; // Fine: 0.1 meters\r\n        if (event.ctrlKey) step = 10.0; // Coarse: 10 meters\r\n\r\n        // Apply adjustments based on key\r\n        switch (event.key.toLowerCase()) {\r\n            case 'a': // Move Left\r\n                app.debugOffsets.x -= step;\r\n                break;\r\n            case 'd': // Move Right\r\n                app.debugOffsets.x += step;\r\n                break;\r\n            case 'w': // Move Forward\r\n                app.debugOffsets.y += step;\r\n                break;\r\n            case 's': // Move Backward\r\n                app.debugOffsets.y -= step;\r\n                break;\r\n            case 'q': // Move Down\r\n                app.debugOffsets.z -= step;\r\n                break;\r\n            case 'e': // Move Up\r\n                app.debugOffsets.z += step;\r\n                break;\r\n            default:\r\n                return; // Not a control key, don't update UI\r\n        }\r\n\r\n        updateDebugUI();\r\n        console.log(`üîß Offset adjusted: X=${app.debugOffsets.x.toFixed(2)}, Y=${app.debugOffsets.y.toFixed(2)}, Z=${app.debugOffsets.z.toFixed(2)}`);\r\n    });\r\n\r\n    setupFilterListeners();\r\n}\r\n\r\n/**\r\n * Update Debug UI with current offset values\r\n */\r\nfunction updateDebugUI() {\r\n    document.getElementById('debugOffsetX').textContent = `${app.debugOffsets.x.toFixed(2)} m`;\r\n    document.getElementById('debugOffsetY').textContent = `${app.debugOffsets.y.toFixed(2)} m`;\r\n    document.getElementById('debugOffsetZ').textContent = `${app.debugOffsets.z.toFixed(2)} m`;\r\n\r\n    setupFilterListeners();\r\n\r\n}\r\n\r\n/**\r\n * Set trace visibility\r\n * @param {boolean} visible \r\n */\r\nfunction setTraceVisibility(visible) {\r\n    app.filters.showTraces = visible;\r\n    const toggleTraces = document.getElementById('toggleTraces');\r\n    if (toggleTraces) {\r\n        toggleTraces.classList.toggle('active', visible);\r\n    }\r\n    app.viewer?.scene?.requestRender();\r\n}\r\n\r\n/**\r\n * Setup Filter UI listeners\r\n */\r\nfunction setupFilterListeners() {\r\n    const toggleAirports = document.getElementById('toggleAirports');\r\n    const toggleTraces = document.getElementById('toggleTraces');\r\n\r\n    toggleAirports?.addEventListener('click', () => {\r\n        app.filters.showAirports = !app.filters.showAirports;\r\n        toggleAirports.classList.toggle('active', app.filters.showAirports);\r\n        renderAirports();\r\n\r\n        // Toggle Runway/Taxiway Overlay\r\n        const runwayDS = app.viewer.dataSources.getByName('airport-surfaces');\r\n        if (runwayDS && runwayDS.length > 0) {\r\n            runwayDS[0].show = app.filters.showAirports;\r\n        }\r\n    });\r\n\r\n    toggleTraces?.addEventListener('click', () => {\r\n        app.filters.showTraces = !app.filters.showTraces;\r\n        toggleTraces.classList.toggle('active', app.filters.showTraces);\r\n        // The CallbackProperty in entity.path.show will automatically pick this up\r\n        // but we might need to request a render\r\n        app.viewer.scene.requestRender();\r\n    });\r\n}\r\n\r\n/**\r\n * Handle search input\r\n */\r\nfunction handleSearch(event) {\r\n    const query = event.target.value.trim().toUpperCase();\r\n    app.searchQuery = query;\r\n\r\n    // Clear existing timeout\r\n    if (app.searchTimeout) {\r\n        clearTimeout(app.searchTimeout);\r\n    }\r\n\r\n    if (!query) {\r\n        renderSearchResults([]);\r\n        updateAircraftDisplay();\r\n        return;\r\n    }\r\n\r\n    // Debounce search (300ms)\r\n    app.searchTimeout = setTimeout(async () => {\r\n        console.log('Searching for:', query);\r\n        const results = await performSearch(query);\r\n        renderSearchResults(results);\r\n        updateAircraftDisplay();\r\n    }, 300);\r\n}\r\n\r\n/**\r\n * Perform search for cities, airports, and flights\r\n */\r\nasync function performSearch(query) {\r\n    if (!query || query.length < 2) return [];\r\n\r\n    const results = [];\r\n\r\n    // 1. Search Airports\r\n    const airportMatches = AIRPORTS.filter(a =>\r\n        a.name.toUpperCase().includes(query) ||\r\n        a.icao.toUpperCase().includes(query)\r\n    );\r\n    airportMatches.forEach(a => results.push({\r\n        type: 'AIRPORT',\r\n        label: `${a.icao} - ${a.name}`,\r\n        data: a,\r\n        id: `airport-${a.icao}`\r\n    }));\r\n\r\n    // 2. Search Flights (Currently tracked on map)\r\n    const entities = app.viewer.entities.values;\r\n    const aircraftMatches = entities.filter(e =>\r\n        e.properties && e.properties.type && e.properties.type.getValue() === 'aircraft' &&\r\n        (e.properties.callsign.getValue().toUpperCase().includes(query) || e.id.toUpperCase().includes(query))\r\n    );\r\n    aircraftMatches.forEach(e => results.push({\r\n        type: 'FLIGHT',\r\n        label: `${e.properties.callsign.getValue()} (${e.id})`,\r\n        data: e,\r\n        id: e.id\r\n    }));\r\n\r\n    // 3. Search Cities/Locations (via Geocoder)\r\n    try {\r\n        const geoResults = await app.geocoder.geocode(query);\r\n        if (geoResults && geoResults.length > 0) {\r\n            geoResults.forEach(res => results.push({\r\n                type: 'CITY',\r\n                label: res.displayName,\r\n                data: res,\r\n                id: `geo-${res.displayName}`\r\n            }));\r\n        }\r\n    } catch (error) {\r\n        console.error('Geocoder error:', error);\r\n    }\r\n\r\n    return results;\r\n}\r\n\r\n/**\r\n * Render search results dropdown\r\n */\r\nfunction renderSearchResults(results) {\r\n    const resultsContainer = document.getElementById('searchResults');\r\n    if (!resultsContainer) return;\r\n\r\n    if (results.length === 0) {\r\n        resultsContainer.innerHTML = '';\r\n        resultsContainer.style.display = 'none';\r\n        return;\r\n    }\r\n\r\n    resultsContainer.innerHTML = results.map(res => `\r\n        <div class=\"search-result-item\" data-id=\"${res.id}\">\r\n            <span class=\"result-type\">[${res.type}]</span>\r\n            <span class=\"result-label\">${res.label}</span>\r\n        </div>\r\n    `).join('');\r\n\r\n    resultsContainer.style.display = 'block';\r\n\r\n    // Add click listeners to results\r\n    resultsContainer.querySelectorAll('.search-result-item').forEach((item, index) => {\r\n        item.addEventListener('click', () => {\r\n            selectSearchResult(results[index]);\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Handle selection of a search result\r\n */\r\nfunction selectSearchResult(result) {\r\n    const { type, data, id } = result;\r\n    console.log('Selected search result:', result);\r\n\r\n    // Clear search\r\n    const searchInput = document.getElementById('searchInput');\r\n    if (searchInput) searchInput.value = '';\r\n    renderSearchResults([]);\r\n    app.searchQuery = '';\r\n\r\n    if (type === 'CITY') {\r\n        app.viewer.camera.flyTo({\r\n            destination: data.destination,\r\n            duration: 3\r\n        });\r\n        updateStatus(`VIEWING: ${data.displayName.toUpperCase()}`);\r\n    } else if (type === 'AIRPORT') {\r\n        const entity = app.viewer.entities.getById(id);\r\n        if (entity) {\r\n            app.viewer.flyTo(entity, {\r\n                offset: new Cesium.HeadingPitchRange(0, Cesium.Math.toRadians(-45), 25000),\r\n                duration: 3\r\n            });\r\n            showAircraftDetails(entity);\r\n        } else {\r\n            // Airport might not be in the collection or hidden\r\n            app.viewer.camera.flyTo({\r\n                destination: Cesium.Cartesian3.fromDegrees(data.lon, data.lat, 25000),\r\n                duration: 3\r\n            });\r\n        }\r\n    } else if (type === 'FLIGHT') {\r\n        const entity = app.viewer.entities.getById(id);\r\n        if (entity) {\r\n            app.viewer.camera.flyTo({\r\n                destination: entity.position.getValue(app.viewer.clock.currentTime),\r\n                offset: new Cesium.HeadingPitchRange(0, Cesium.Math.toRadians(-45), 5000),\r\n                duration: 3\r\n            });\r\n            showAircraftDetails(entity);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Get airliner name from callsign\r\n */\r\n/**\r\n * Get airliner name from callsign\r\n */\r\nfunction getAirlinerFromCallsign(callsign) {\r\n    if (!callsign) return 'GENERAL AVIATION';\r\n    const code = callsign.substring(0, 3).trim();\r\n    return ICAO_AIRLINES[code]?.name || 'PRIVATE/CHARTER';\r\n}\r\n\r\n/**\r\n * Get IATA flight number from ICAO callsign\r\n * e.g., THY123 -> TK 123\r\n */\r\nfunction getFlightNumberFromCallsign(callsign) {\r\n    if (!callsign) return '‚Äî';\r\n\r\n    // Extract 3-letter ICAO code\r\n    const icao = callsign.substring(0, 3).toUpperCase();\r\n\r\n    // Check if we have a mapping\r\n    if (ICAO_AIRLINES[icao]) {\r\n        const iata = ICAO_AIRLINES[icao].iata;\r\n        // Extract the flight number part (everything after the first 3 chars)\r\n        // Remove leading zeros for cleaner look (e.g. 009 -> 9)\r\n        let number = callsign.substring(3).trim();\r\n        number = number.replace(/^0+/, '');\r\n\r\n        return `${iata} ${number}`;\r\n    }\r\n\r\n    // Use fallback regex to separate letters and numbers if unknown airline\r\n    const match = callsign.match(/^([A-Z]+)(\\d+.*)$/);\r\n    if (match) {\r\n        return `${match[1]} ${match[2]}`;\r\n    }\r\n\r\n    return callsign;\r\n}\r\n\r\n/**\r\n * Show aircraft details panel\r\n */\r\nfunction showAircraftDetails(entity) {\r\n    app.selectedAircraft = entity;\r\n\r\n    // Show selection bracket\r\n    if (app.selectionBracket) {\r\n        app.selectionBracket.position = entity.position;\r\n        app.selectionBracket.show = true;\r\n    }\r\n\r\n    const panel = document.getElementById('aircraftDetails');\r\n    panel?.classList.remove('hidden');\r\n\r\n    const isAirport = entity.properties && entity.properties.type && entity.properties.type.getValue() === 'airport';\r\n\r\n    // UI Elements\r\n    const titleEl = document.querySelector('.panel-title');\r\n    const labels = document.querySelectorAll('.data-label');\r\n    const values = document.querySelectorAll('.data-value');\r\n\r\n    // Mappings for easier access\r\n    const ui = {\r\n        airliner: document.getElementById('detailAirliner'),\r\n        flightNum: document.getElementById('detailFlightNum'),\r\n        callsign: document.getElementById('detailCallsign'),\r\n        altitude: document.getElementById('detailAltitude'),\r\n        velocity: document.getElementById('detailVelocity'),\r\n        heading: document.getElementById('detailHeading'),\r\n        origin: document.getElementById('detailOrigin')\r\n    };\r\n\r\n    if (isAirport) {\r\n        // Airport Mode\r\n        titleEl.textContent = 'AIRPORT DATA';\r\n\r\n        if (ui.airliner) ui.airliner.parentElement.style.display = 'none';\r\n        if (ui.flightNum) ui.flightNum.parentElement.style.display = 'none';\r\n\r\n        labels[1].textContent = 'NAME:';         // Callsign (Index 1) -> NAME\r\n        ui.callsign.textContent = entity.properties.name.getValue();\r\n\r\n        labels[3].textContent = 'ALTITUDE:';     // Altitude (Index 3) -> ALTITUDE\r\n        const airportPos = entity.position.getValue(app.viewer.clock.currentTime);\r\n        const cartographic = Cesium.Cartographic.fromCartesian(airportPos);\r\n        ui.altitude.textContent = `${Math.round(cartographic.height)} M`;\r\n\r\n        labels[4].textContent = 'ICAO:';         // Velocity (Index 4) -> ICAO\r\n        ui.velocity.textContent = entity.properties.icao.getValue();\r\n\r\n        // Get lat/lon from cartographic\r\n        labels[5].textContent = 'LAT:';          // Heading (Index 5) -> LAT\r\n        ui.heading.textContent = Cesium.Math.toDegrees(cartographic.latitude).toFixed(4);\r\n\r\n        labels[6].textContent = 'LON:';          // Origin (Index 6) -> LON\r\n        ui.origin.textContent = Cesium.Math.toDegrees(cartographic.longitude).toFixed(4);\r\n\r\n        // Hide Follow/Ground buttons\r\n        document.getElementById('detailFollow').style.display = 'none';\r\n        document.getElementById('detailGround').style.display = 'none';\r\n\r\n    } else {\r\n        // Aircraft Mode\r\n        titleEl.textContent = 'AIRCRAFT DATA';\r\n\r\n        // Show all rows\r\n        Object.values(ui).forEach(el => {\r\n            if (el) el.parentElement.style.display = 'flex';\r\n        });\r\n\r\n        // 1. Clear Fields First (Prevent Stale Data)\r\n        ui.airliner.textContent = '...';\r\n        ui.flightNum.textContent = '...';\r\n        ui.callsign.textContent = '...';\r\n        ui.altitude.textContent = '...';\r\n        ui.velocity.textContent = '...';\r\n        ui.heading.textContent = '...';\r\n        ui.origin.textContent = '...';\r\n\r\n        // 2. Populate Fresh Data\r\n        const callsign = entity.properties.callsign.getValue() || 'N/A';\r\n        ui.airliner.textContent = getAirlinerFromCallsign(callsign);\r\n        ui.flightNum.textContent = getFlightNumberFromCallsign(callsign);\r\n        ui.callsign.textContent = callsign;\r\n\r\n        labels[1].textContent = 'CALLSIGN:'; // Index 1\r\n        labels[3].textContent = 'ALTITUDE:'; // Index 3\r\n        labels[4].textContent = 'VELOCITY:'; // Index 4\r\n        labels[5].textContent = 'HEADING:';  // Index 5\r\n        labels[6].textContent = 'ORIGIN:';   // Index 6\r\n\r\n        // Use precise current values if possible, otherwise fallback to property\r\n        const currentTime = app.viewer.clock.currentTime;\r\n\r\n        let altMeters = 0;\r\n        const position = entity.position.getValue(currentTime);\r\n        if (position) {\r\n            const carto = Cesium.Cartographic.fromCartesian(position);\r\n            altMeters = carto.height;\r\n        } else {\r\n            altMeters = entity.properties.altitude.getValue() || 0;\r\n        }\r\n\r\n        const altFeet = Math.round(altMeters * 3.28084);\r\n        ui.altitude.textContent = `${altFeet.toLocaleString()} FT`;\r\n\r\n        // Velocity\r\n        const vel = entity.properties.velocity.getValue();\r\n        ui.velocity.textContent = `${Math.round(vel)} KTS`;\r\n\r\n        // Heading\r\n        // Ideally get current heading from orientation, but property is fine for snapshot\r\n        const hdg = entity.properties.heading.getValue();\r\n        ui.heading.textContent = `${Math.round(hdg)}¬∞`;\r\n\r\n        ui.origin.textContent = entity.properties.origin.getValue() || 'N/A';\r\n\r\n        // Show action buttons\r\n        document.getElementById('detailFollow').style.display = 'flex';\r\n        document.getElementById('detailGround').style.display = 'flex';\r\n    }\r\n}\r\n\r\n// REMOVED: updateSelectedAircraftUI \r\n// Real-time updates caused flickering and inconsistency. \r\n// Data is now static snapshots upon selection.\r\n\r\n\r\n\r\n/**\r\n * Check if bounds have changed significantly\r\n */\r\nfunction boundsChangedSignificantly(oldBounds, newBounds) {\r\n    if (!oldBounds || !newBounds) return true;\r\n\r\n    // Calculate the change in each dimension (in degrees)\r\n    const latChange = Math.abs(oldBounds.lamin - newBounds.lamin) + Math.abs(oldBounds.lamax - newBounds.lamax);\r\n    const lonChange = Math.abs(oldBounds.lomin - newBounds.lomin) + Math.abs(oldBounds.lomax - newBounds.lomax);\r\n\r\n    // Threshold: refresh if bounds changed by more than 20% of the viewport\r\n    const latThreshold = Math.abs(oldBounds.lamax - oldBounds.lamin) * 0.2;\r\n    const lonThreshold = Math.abs(oldBounds.lomax - oldBounds.lomin) * 0.2;\r\n\r\n    return latChange > latThreshold || lonChange > lonThreshold;\r\n}\r\n\r\n/**\r\n * Fetch and update aircraft for current view\r\n */\r\nasync function refreshAircraftData() {\r\n    const newBounds = getCameraViewportBounds();\r\n\r\n    // Only fetch if bounds changed significantly\r\n    if (boundsChangedSignificantly(app.lastFetchBounds, newBounds)) {\r\n        console.log('üìç Camera moved to new region, refreshing aircraft...');\r\n        app.lastFetchBounds = newBounds;\r\n        const data = await fetchAircraftData(newBounds);\r\n        updateAircraftDisplay(data);\r\n    }\r\n}\r\n\r\n/**\r\n * Setup camera movement listener\r\n */\r\nfunction setupCameraListener() {\r\n    if (!app.viewer) return;\r\n\r\n    // Listen for camera movement end (debounced)\r\n    app.viewer.camera.moveEnd.addEventListener(() => {\r\n        // Clear existing timeout\r\n        if (app.cameraMoveTimeout) {\r\n            clearTimeout(app.cameraMoveTimeout);\r\n        }\r\n\r\n        // Debounce: wait 500ms after camera stops moving\r\n        app.cameraMoveTimeout = setTimeout(() => {\r\n            refreshAircraftData();\r\n        }, 500);\r\n    });\r\n}\r\n\r\n/**\r\n * Start data update loop\r\n */\r\nfunction startDataLoop() {\r\n    // Initial fetch\r\n    refreshAircraftData();\r\n\r\n    // Update every 30 seconds to stay within OpenSky rate limits\r\n    // With 4000 credits/day: 4000 √∑ 24 hours = ~166 requests/hour = ~2880 requests/day (safe buffer)\r\n    // 30 seconds = 2 requests/minute = 120 requests/hour = 2880 requests/day ‚úÖ\r\n    app.updateInterval = setInterval(async () => {\r\n        refreshAircraftData();\r\n    }, 30000); // 30 seconds = 30,000 milliseconds\r\n\r\n    // Setup camera movement listener for immediate updates when navigating\r\n    setupCameraListener();\r\n}\r\n\r\n/**\r\n * Hide loading screen\r\n */\r\nfunction hideLoadingScreen() {\r\n    const loadingScreen = document.getElementById('loadingScreen');\r\n    if (loadingScreen) {\r\n        loadingScreen.classList.add('fade-out');\r\n        setTimeout(() => {\r\n            loadingScreen.style.display = 'none';\r\n        }, 500);\r\n    }\r\n}\r\n\r\n/**\r\n * Render airports based on visibility filter\r\n */\r\nfunction renderAirports() {\r\n    if (!app.viewer) return;\r\n\r\n    // Clear existing airports first (to avoid duplicates or update style)\r\n    // We'll use a specific ID prefix or manage a collection\r\n    // Simple approach: Use entities with a specific property\r\n\r\n    // Actually, improved approach: Create them once, and just toggle 'show'\r\n\r\n    const entities = app.viewer.entities.values;\r\n    const airportEntities = entities.filter(e => e.properties && e.properties.type && e.properties.type.getValue() === 'airport');\r\n\r\n    if (airportEntities.length === 0 && app.filters.showAirports) {\r\n        // Create airports if they don't exist and we want to show them\r\n        AIRPORTS.forEach(airport => {\r\n            app.viewer.entities.add({\r\n                position: Cesium.Cartesian3.fromDegrees(airport.lon, airport.lat, airport.alt),\r\n                point: {\r\n                    pixelSize: 10,\r\n                    color: Cesium.Color.fromCssColorString('#00ff41').withAlpha(0.6),\r\n                    outlineColor: Cesium.Color.BLACK,\r\n                    outlineWidth: 2,\r\n                    disableDepthTestDistance: Number.POSITIVE_INFINITY\r\n                },\r\n                label: {\r\n                    text: airport.name, // Display Name\r\n                    font: '10px JetBrains Mono',\r\n                    style: Cesium.LabelStyle.FILL_AND_OUTLINE,\r\n                    fillColor: Cesium.Color.fromCssColorString('#00ff41'),\r\n                    outlineColor: Cesium.Color.BLACK,\r\n                    outlineWidth: 2,\r\n                    verticalOrigin: Cesium.VerticalOrigin.TOP,\r\n                    pixelOffset: new Cesium.Cartesian2(0, 10),\r\n                    distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0, 100000), // Only show labels when close\r\n                    disableDepthTestDistance: Number.POSITIVE_INFINITY\r\n                },\r\n                properties: {\r\n                    type: 'airport',\r\n                    name: airport.name,\r\n                    icao: airport.icao\r\n                }\r\n            });\r\n        });\r\n    } else {\r\n        // Update visibility\r\n        airportEntities.forEach(entity => {\r\n            entity.show = app.filters.showAirports;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Initialize application\r\n */\r\nasync function init() {\r\n    try {\r\n        updateStatus('INITIALIZING');\r\n\r\n        // Initialize Cesium\r\n        await initCesiumViewer();\r\n\r\n        // Setup UI\r\n        setupEventListeners();\r\n\r\n        // Initial render of airports\r\n        renderAirports();\r\n\r\n        // Start data updates\r\n        startDataLoop();\r\n\r\n        // Hide loading screen\r\n        setTimeout(hideLoadingScreen, 1000);\r\n\r\n\r\n        updateStatus('OPERATIONAL');\r\n    } catch (error) {\r\n        console.error('Initialization error:', error);\r\n        updateStatus('INITIALIZATION FAILED', true);\r\n    }\r\n}\r\n\r\n// Start application when DOM is ready\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', init);\r\n} else {\r\n    init();\r\n}\r\n"],"names":["fetchAirportDetails","response","error","loadRunwaySurfaces","viewer","app","data","dataSource","icao","details","longestRunway","maxLength","feature","positions","cartesians","length","i","airportEntity","p1","p2","center","CESIUM_ION_TOKEN","OPENSKY_USERNAME","OPENSKY_PASSWORD","MAX_AIRCRAFT_DISPLAY","ICAO_AIRLINES","AIRPORTS","initCesiumViewer","layer","scene","updateCamera","createSelectionBracket","initializeAirports","size","canvas","ctx","color","thickness","len","hiddenIcaos","airport","shouldHideVisuals","entityOptions","getCameraViewportBounds","camera","topLeft","topRight","bottomLeft","bottomRight","corners","cartesian","cartographic","lats","c","lons","fetchAircraftData","bounds","bbox","isProduction","url","errorText","_a","updateStatus","rateLimitRemaining","rateLimitReset","filterAircraftForDisplay","aircraftData","validAircraft","state","longitude","latitude","baro_altitude","on_ground","geo_altitude","query","callsign","_b","origin","_c","sorted","a","b","altA","predictPosition","altitude","velocity","heading","verticalRate","seconds","EARTH_RADIUS","headingRad","distance","latRad","deltaLat","deltaLon","newLatitude","newLongitude","newAltitude","createInterpolatedPosition","entity","currentTime","futureTime","positionProperty","startPosition","visualPosition","predicted","futurePosition","updateAircraftDisplay","entities","currentIds","icao24","origin_country","time_position","last_contact","true_track","vertical_rate","sensors","squawk","spi","position_source","id","trackId","velocityMs","verticalRateMs","trackEntity","visualEntity","time","result","pos","carto","groundPos","MODEL_OFFSET_X","MODEL_OFFSET_Y","MODEL_OFFSET_Z","translationCallback","y","z","nodeTransform","transformations","cameraPos","entityPos","dist","near","far","allEntities","totalAvailable","stopCameraModes","position","orientation","headingPitchRange","targetPos","direction","startTracking","setTraceVisibility","startFollowing","startGroundView","text","isError","statusText","statusIndicator","setupEventListeners","searchInput","handleSearch","click","pickedObjects","targetEntity","picked","showAircraftDetails","_d","_e","_f","_g","updateDebugUI","_h","offsetText","err","_i","event","controlKeys","debugPanel","step","setupFilterListeners","visible","toggleTraces","toggleAirports","renderAirports","runwayDS","renderSearchResults","results","performSearch","e","geoResults","res","resultsContainer","item","index","selectSearchResult","type","getAirlinerFromCallsign","code","getFlightNumberFromCallsign","iata","number","match","panel","isAirport","titleEl","labels","ui","airportPos","el","altMeters","altFeet","vel","hdg","boundsChangedSignificantly","oldBounds","newBounds","latChange","lonChange","latThreshold","lonThreshold","refreshAircraftData","setupCameraListener","startDataLoop","hideLoadingScreen","loadingScreen","airportEntities","init"],"mappings":"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"}